#{extends 'laySeg.html' /} 
#{set title:'Pedidos Recusados' /}
<div id="corpoCelular" class="heightMin">		
	<div class="h1 text-danger text-center tituloCelular">Lista de Pedidos Recusados</div><br>
#{if listaRecusados.size() == 0}
<!-- informa se n�o houver ou n�o encontrar nenhum pedido-->
	<div class="h1 text-primary text-center tituloCelular">(Nenhum Pedido Foi Encontrado!)</div><br>
#{/if} 
#{else}
	<div class="row font-size-celular">
		<div class="col">
		    <div class="collapse multi-collapse m-0 p-0" id="multiCollapseExample1">
				<div class="card card-body m-0 p-0">
#{if listaRecusados.size() > -1}
<!-- Filtro por nome do usuario e nome do arquivo -->
					<form action="@{Pedidos.listarRecusados}" method="post">
						<fieldset class="corFiltro shadow-lg rounded">
					        <legend>Filtrar Por:</legend>
							<div class="form-row">
						    	<div class="form-group col-md-6">
							    	<label for="matriculaDoUsuarioFiltro">Matricula do Usuário:</label>
									<input type="text" name="matriculaDoUsuarioFiltro" class="form-control hei-size-celular font-size-celular" 
									placeholder="Matricula do usuario" id="matriculaDoUsuarioFiltro" maxlength="100" value="${matriculaDoUsuarioFiltro}">
						    	</div>
						   		<div class="form-group col-md-6">
							    	<label for="nomeDoArquivoFiltro">Nome do Arquivo:</label>
									<input type="text" name="nomeDoArquivoFiltro" class="form-control hei-size-celular font-size-celular" 
									placeholder="Nome do Arquivo" id="nomeDoArquivoFiltro" maxlength="100" value="${nomeDoArquivoFiltro}">
						    	</div>
					  		</div>
					 		<div class="text-center"">
						  		<button type="submit" class="btn btn-primary icon font-size-celular">Filtrar <i class="filter icon"></i></button>
						  		<span class="btn btn-danger icon font-size-celular" id="limpar">Limpar <i class="eraser icon"></i></span>
						 	</div>
						</fieldset>
					</form><br><br>
<!-- Fim Filtro -->
#{/if}
				</div>
			</div>
  		</div>
  	</div>
	<div class="container font-size-celular">
 		<div class="row">
#{list items:listaRecusados, as:'pr'}
<!-- listar todos os pedidos recusados (se houver) -->
	   		<div class="col-lg-6">
				<div class="card text-white bg-dark mb-3" style="max-width: 100%;">
					<div class="card-header text-center pt-1 pb-1">
						<div class="text-primary m-0 h6">Usuario:</div>
				${pr.usuario.nomeUsu}<br />
						<span class="desaparecer-celular">
							<div class="text-primary m-0 desaparecer-celular h6">Matricula:</div>
				${pr.usuario.matricula}
						</span>
					</div>
					<div class="card-body pt-0 pb-1">
						<div class="card-text">
							<b>Arquivo: </b> ${pr.nomeArquivo}
						</div>
						<div class="card-text">
							<b>Status: </b>
							<div class="listaRecusado text-white text-center rounded statusRecusado">${pr.status}</div> 
						</div>
						<div class="mt-1">
					  		<button class="btn btn-outline-info m-0 mb-1 btn-sm btn-block font-size-celular" data-toggle="collapse" href="#collapseExample${pr.id}" role="button" 
					  		aria-expanded="false" aria-controls="collapseExample"><i class="plus icon"></i><span class="desaparecer-celular">Informacoes</span></button>
						</div>
						<div class="collapse text-left" id="collapseExample${pr.id}">
					  		<div class="card bg-dark">
					  			<div class="card-text">
									<b>Cópias: </b> ${pr.qtdCopias}
								</div>
								<div class="card-text">
									<b>Face: </b> ${pr.frenteVerso}
								</div>
								<div class="card-text">
						 			<b>Descricao: </b> ${pr.descricao} 
#{if pr.descricao == null}(sem descricao) #{/if}<br />
								</div>
								<div class="card-text">
									<b>Data de Envio: </b><br> ${pr.dataEnvio}
								</div>
								<div class="card-text">
									<b>Data de Atendimento: </b><br>${pr.dataAtendimento}
								</div>
							</div>
						</div>
						<div class="card-text text-center">
							<div class="sticky-top">
								<a href="@{Administradores.download(pr.id)}" class="btn btn-primary m-1 icon font-size-celular">
									<span class="desaparecer-celular">Download</span>
									<i style="float: right; margin: 1px;" class="download icon"></i>
								</a>
								<a class="concluir font-size-celular" data-item="${pr.id}" href="#Concluir" style="font-size: medium; text-decoration: none; color: white;">
									<span class="btn btn-success mt-1 mb-1 icon font-size-celular" ><span class="desaparecer-celular">Concluir</span>
									<i style="float: right; margin: 1px;" class="check icon"></i></span>
								</a>
							</div>
						</div>
					</div>
				</div>
	 		</div>
#{/list}
		</div>
	</div>		
#{/else}
</div>
<form id="con" action="@{Pedidos.recusarParaConcluido}">
	<input type="hidden" id="idPedCon" name="idPedCon" />
	<input type="hidden" id="resposta" name="resposta" />
</form>
<script type="text/javascript">
$(document).ready(function () {
	$(".concluir").click(function() {
		var idPedido = $(this).data("item");
		Swal.fire({
			title: 'Mensagem de conclusão:',
			input: 'text',
			inputPlaceholder: 'digite alguma mensagem complementar',
			inputAttributes: {
				'aria-label': 'Type your message here'
			},
			showCloseButton: true,
			showCancelButton: true,
			showClass: {
				popup: 'animated fadeInDown faster'
			},
			hideClass: {
			    popup: 'animated fadeOutUp faster'
			}
		}).then((result) => {
			if(result.value == ""){
				result.value = ".";
			}
			if (result.value) {
				$('#idPedCon').val(idPedido);
				$('#resposta').val(result.value);
				$('#con').submit();
			}
		})
	});
});
</script>

