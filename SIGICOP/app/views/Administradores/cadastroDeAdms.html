#{extends 'laySeg.html' /} 
#{set title:'Cadastro de Administrador(res)' /}
<div id="corpoCelular" class="heightMin">
#{if !adm?.id}
	<div class="h1 text-dark text-center tituloCelular";">Cadastro de Adminstradores</div><br>
#{/if}
#{else}
	<div class="h1 text-dark text-center tituloCelular">Editar Meus Dados</div>
#{/else}
	<div class="text-center m-0">
#{ifErrors}
		<div class="h2 m-0 ops" style="color: red;">Ops...</div>
		<!--#{errors}
		<li>${error.key} - ${error} - ${error.message}</li>
		#{/errors}-->
#{/ifErrors}
	</div>			 
	<div class="ui middle aligned center aligned grid mt-0 m-0-celular p-0-celular">
		<div class="column mt-0 m-0-celular p-0-celular">
<!-- FORMULARIO DE CADASTRO E EDI��O DO ADMIN -->
			<form action="@{Administradores.salvarAdm} " class="ui segment m-0-celular p-0-celular mt-n2" method="post">
				<div class=" ml-1 mr-1 mb-0 mt-0 pl-3 pr-3 pb-2 pt-0">
				<input type="hidden" name="adm.id" value="${adm?.id}">
					<label class="font-size-celular m-1" for="nomeAdm">Nome:</label>	
					<span id="validacaoServidoNomeAdmin" class="alert-danger shadow-sm rounded p-0 font-size-celular validacaoMsgm">#{error 'adm.nomeAdm' /}</span>
					<span id="validarNomeAdmin"></span>
					<input type="text" name="adm.nomeAdm" placeholder="nome" class="form-control hei-input-celular font-size-celular" 
					 autocomplete="off" id="nomeAdm" value="${adm?.nomeAdm}" onchange="validarNomeAdmin()">
					 
					<label for="email" class="m-1 font-size-celular">Email:</label>
					<span id="validacaoServidoEmailAdmin" class="alert-danger shadow-sm rounded p-0 font-size-celular validacaoMsgm">#{error 'adm.email' /}</span>
#{if email}		
					<span id="validacaoServidorExisteEmailAdmin" class="alert-danger shadow-sm rounded p-0 font-size-celular validacaoMsgm">${email}</span>
#{/if}
					<span id="validarEmailAdmin"></span>
					<input type="email" name="adm.email" placeholder="Email" class="form-control hei-input-celular font-size-celular" 
					autocomplete="off" id="email" value="${adm?.email}" onchange="validarEmailAdmin()">
#{if !adm?.id}
					<label for="inputSenhaA" class="m-1 font-size-celular">Senha:</label>
					<span id="validacaoServidorsenhaA" class="alert-danger shadow-sm rounded p-0 font-size-celular validacaoMsgm">#{error 'adm.senha' /}</span>
					<span id="validarSeA"></span>
					<input type="password" name="adm.senha" placeholder="Senha" class="form-control hei-input-celular font-size-celular" 
					id="inputSenhaA" onchange="validarsenhaAdm()">
					
					<label for="confimar" class="m-1 mr-0 font-size-celular">Confimar Senha:</label>
#{if comparar}		
					<span id="validacaoServidoComfirmarAdmin" class="alert-danger shadow-sm rounded p-0 font-size-celular validacaoMsgm">${comparar}</span>
#{/if}
					<span id="Comparar"></span>
					<input type="password" name="adm.confirmarSenha" placeholder="Confirmar Senha" 
					class="form-control hei-input-celular font-size-celular" id="confimar" onchange="validarsenhaAdm()">
					
					<!-- BOTÃO DE CADASTRAR -->
					<input type="submit" class="btn btn-lg btn-primary btn-block mt-3 font-size-celular" value="Cadastrar" />					
#{/if}
#{else}				<!-- BOTÃO DE EDITAR -->
					<a href="@{Administradores.editarSenha}" class="btn btn-dark mt-2 font-size-celular">Alterar Senha</a>
					<input type="submit" class="btn btn-lg btn-primary btn-block mt-3 font-size-celular" value="Editar" />					
#{/else}
				</div>
			</form>
		</div>
	</div>
</div>
<!-- validação ao alterar algum dado do formulário -->
<script type="text/javascript">
function validarNomeAdmin(){		// nome do campo
	// nome do admin
	var nome = document.getElementById('nomeAdm').value;
	var sobreNome = nome.split(' ')[1];// separar a segunda str por espa�os
	
	if (nome == '') { // se nome contém nada
	 	document.getElementById("validarNomeAdmin").innerHTML = '<span class="alert-danger shadow-sm rounded p-0 font-size-celular validacaoMsgm">obrigatório</span>'
	 	document.getElementById("nomeAdm").style = 'border-color: #dc3545;'
	 	document.getElementById("validacaoServidoNomeAdmin").style = 'display: none;'
	}else {
		if(sobreNome == null || sobreNome == ""){
			document.getElementById("validarNomeAdmin").innerHTML = '<span class="alert-danger shadow-sm rounded p-0 font-size-celular validacaoMsgm">sobrenome é obrigatório</span>'
		 	document.getElementById("nomeAdm").style = 'border-color: #dc3545;'
		 	document.getElementById("validacaoServidoNomeAdmin").style = 'display: none;'
		}else{
		 	document.getElementById("validarNomeAdmin").innerHTML = '<span class="alert-success shadow-sm rounded p-0 font-size-celular validacaoMsgm"><i class="check icon m-0"></i></span>'
			document.getElementById("nomeAdm").style = 'border-color: #28a745'
			document.getElementById("validacaoServidoNomeAdmin").style = 'display: none;'
		}
	}
}
function validarEmailAdmin(){        // nome do campo
	var email = document.getElementById("email").value;
	// email
	console.log(email);
	if (email == '') {
	 	document.getElementById("email").style = 'border-color: #dc3545;'
	 	document.getElementById("validarEmailAdmin").innerHTML = '<span class="alert-danger shadow-sm rounded p-0 font-size-celular validacaoMsgm">obrigatório</span>';
	 	document.getElementById("validacaoServidoEmailAdmin").style = 'display: none;'
	}else{
		usuario = email.substring(0, email.indexOf("@"));
		dominio = email.substring(email.indexOf("@")+ 1, email.length);
		 
		if ((usuario.length >=1) &&
		    (dominio.length >=3) && 
		    (usuario.search("@")==-1) && 
		    (dominio.search("@")==-1) &&
		    (usuario.search(" ")==-1) && 
		    (dominio.search(" ")==-1) &&
		    (dominio.search(".")!=-1) &&      
		    (dominio.indexOf(".") >=1)&& 
		    (dominio.lastIndexOf(".") < dominio.length - 1)) {
		 	document.getElementById("email").style = 'border-color: #28a745;';
		 	document.getElementById("validarEmailAdmin").innerHTML = '<span class="alert-success shadow-sm rounded p-0 font-size-celular validacaoMsgm"><i class="check icon m-0"></i></span>';
		 	document.getElementById("validacaoServidoEmailAdmin").style = 'display: none;'	
#{if email}	
		 	document.getElementById("validacaoServidorExisteEmailAdmin").style = 'display: none;'
#{/if}
		}else{
			document.getElementById("email").style = 'border-color: #dc3545;';
		 	document.getElementById("validarEmailAdmin").innerHTML = '<span class="alert-danger shadow-sm rounded p-0 font-size-celular validacaoMsgm">email invalido</span>';
		 	document.getElementById("validacaoServidoEmailAdmin").style = 'display: none;'
#{if email}	
		 	document.getElementById("validacaoServidorExisteEmailAdmin").style = 'display: none;'
#{/if}
		}
	}
}
</script>
<script type="text/javascript">
function validarsenhaAdm(){
	var senha = document.getElementById("inputSenhaA").value;
	var confimarSenha = document.getElementById("confimar").value;
	
	// comparar senha
	if (confimarSenha.length < 6) {
        console.log("A senhaComparar precisa ter pelo menos seis caracteres.");
        document.getElementById("confimar").style = 'border-color: #dc3545;' // vermelho
	 	document.getElementById("Comparar").innerHTML = '<span class="alert-danger shadow-sm rounded p-0 font-size-celular validacaoMsgm">no mínino 6 caracteres</span>';
#{if comparar}
	 	document.getElementById("validacaoServidoComfirmarAdmin").style = 'display: none;'
#{/if}
	}else{
		document.getElementById("confimar").style = 'border-color: #28a745;';
 		document.getElementById("Comparar").innerHTML = '<span style="display: none;"></span>';
	} 
	// senha
 	if (senha.length < 6) {
		console.log("A senha precisa ter pelo menos seis caracteres.");
		document.getElementById("inputSenhaA").style = 'border-color: #dc3545;' // vermelho
	 	document.getElementById("validarSeA").innerHTML = '<span class="alert-danger shadow-sm rounded p-0 font-size-celular validacaoMsgm">no mínino 6 caracteres</span>';
 		document.getElementById("validacaoServidorsenhaA").style = 'display: none;'
	}else{
 		document.getElementById("inputSenhaA").style = 'border-color: none;';
 		document.getElementById("validarSeA").innerHTML = '<span style="display: none;"></span>';
 		document.getElementById("validacaoServidorsenhaA").style = 'display: none;';
 		document.getElementById("inputSenhaA").style = 'border-color: #28a745;';
	}
	// se a senha é compativel com confirmação senha
	if (senha != '' & confimarSenha != '' & senha != confimarSenha) {
	 	document.getElementById("validarSeA").innerHTML = '<span class="alert-danger shadow-sm-sm rounded p-0 font-size-celular validacaoMsgm">inconpatível</span>';
	 	document.getElementById("Comparar").innerHTML = '<span class="alert-danger shadow-sm rounded p-0 font-size-celular validacaoMsgm">inconpatível</span>';
	 	document.getElementById("confimar").style = 'border-color: #dc3545;' // vermelho
#{if comparar}
	 	document.getElementById("validacaoServidoComfirmarAdmin").style = 'display: none;'
#{/if}
	}else if(senha == confimarSenha & senha.length > 0 & confimarSenha.length > 0){
	 	document.getElementById("validarSeA").innerHTML = '<span class="alert-success shadow-sm-sm rounded p-0 font-size-celular validacaoMsgm"><i class="check icon m-0"></i></span>';
	 	document.getElementById("Comparar").innerHTML = '<span class="alert-success shadow-sm rounded p-0 font-size-celular validacaoMsgm"><i class="check icon m-0"></i></span>';
	 	document.getElementById("confimar").style = 'border-color: #28a745;';
	}
}
</script>